---
title: "Google Docs Update Action"
description: "Learn how to create an execution action that allows Glean Assistant to update Google Documents programmatically"
icon: "file-lines"
---

## Overview

This guide demonstrates how to create an execution action that enables Glean Assistant to update Google Documents. You'll learn how to configure the OpenAPI specification, set up OAuth authentication, and deploy the action for use within your organization.

<Note>
Before proceeding, ensure you have:
- Admin or app developer access to Glean
- Access to Google Cloud Console
- Familiarity with OAuth 2.0 authentication flows
</Note>

## Implementation Steps

<Steps>
  <Step title="Preparing the OpenAPI Specification">
    The first step involves creating a properly formatted OpenAPI specification that defines how Glean Assistant will interact with the Google Docs API. We'll use the following endpoint:

    ```bash
    POST https://docs.googleapis.com/v1/documents/{documentId}:batchUpdate
    ```

    <Info>
    While Google doesn't typically provide OpenAPI specs publicly, you can construct one using their [documentation](https://developers.google.com/docs/api/reference/rest/v1/documents/batchUpdate) or reference third-party sources.
    </Info>

    Here's the complete OpenAPI specification:

    ```yaml
    openapi: 3.0.0
    servers:
      - url: 'https://docs.googleapis.com/'
    info:
      description: Writes Google Docs documents.
      title: Google Docs API
      version: v1
    paths:
      '/v1/documents/{documentId}:batchUpdate':
        post:
          description: >-
            Applies one or more updates to the document. Each request is validated
            before being applied. If any request is not valid, then the entire
            request will fail and nothing will be applied. The updates in your request
            are guaranteed to be applied together atomically.
          operationId: docs.documents.batchUpdate
          parameters:
            - description: >-
                The ID of the document to update. Use glean search to find 
                the relevant document. The documentId usually exists in the
                url of the doc. The syntax of URL (with documentId) is like:
                https://docs.google.com/document/d/<documentId>/edit
                Extract out the documentId from the URL.
              in: path
              name: documentId
              required: true
              schema:
                type: string
          requestBody:
            content:
              application/json:
                schema:
                  type: object
                  properties:
                    requests:
                      type: array
                      maxItems: 2
                      items:
                        type: object
                        properties:
                          insertText:
                            description: >-
                              Inserts text at the specified location. Always use this 
                              operation except when text deletion or text replacement 
                              is required. 
                            type: object
                            properties:
                              location:
                                type: object
                                properties:
                                  index:
                                    description: >-
                                      The zero-based index, in UTF-16 code units. 
                                      Strictly use a value of 1 and nothing else.
                                    format: int32
                                    type: integer
                              text:
                                description: >-
                                  The text to be inserted. This is the most important field
                                  for this text inserting operation. Insert a neatly 
                                  formatted text consisting of multiple paragraphs. Whenever
                                  required, always start with a new line for paragraphs, 
                                  tables, lists for neatness.
                                type: string
                          replaceAllText:
                            description: >- 
                              Replaces all instances of the specified text. 
                              Always use this operation when text deletion 
                              or text replacement is required. 
                            type: object
                            properties:
                              containsText:
                                type: object
                                properties:
                                  matchCase:
                                    description: >-
                                      Indicates whether the search should respect
                                      case: - `True`: the search is case sensitive.
                                      - `False`: the search is case insensitive.
                                    type: boolean
                                    title: Do you want to match case
                                  text:
                                    description: The text to search for in the document.
                                    type: string
                              replaceText:
                                description: >- 
                                  The text that will replace the
                                  matched text. Keep empty for deletion.
                                type: string
          responses:
            '200':
              description: Successful response
    ```
  </Step>

  <Step title="Creating the Action">
    Navigate to [Admin console > Platform > Actions](https://app.glean.com/admin/platform/tools) and create a new action from scratch.

    ### Basic Information Configuration
    <Frame>
      ![Basic Info Dialog Box](./images/basic_info.png)
    </Frame>

    Configure the following settings:
    - Display name: Choose a descriptive name (e.g., "Google Docs Updater")
    - Description: Explain the action's functionality
    - Unique identifier: Set a unique ID (e.g., "googleDocsUpdate")
    - Action type: Select "Action" since this will modify documents

    ### Trigger Condition Setup
    <Frame>
      ![Trigger Condition Dialog Box](./images/trigger_condition.png)
    </Frame>

    In the trigger condition, provide comprehensive guidance for when Glean Assistant should use this action. Include:
    - Specific use cases that should trigger the action
    - Examples of appropriate user queries
    - Cases where the action should not be used

    ### Functionality Configuration
    <Frame>
      ![Functionality Dialog Box](./images/functionality.png)
    </Frame>

    Paste the OpenAPI specification you prepared in Step 1. Since we're using Google's API directly, leave the "Use existing on-premise server" option unchecked.
  </Step>

  <Step title="Setting Up Authorization">
    The action requires OAuth 2.0 authentication to interact with Google Docs securely.

    ### Google Cloud Console Configuration
    1. Visit the [Google Cloud Console Credentials page](https://console.cloud.google.com/apis/credentials)
    2. Create new OAuth 2.0 credentials:
       <Frame>
         ![GCP Credentials Dialog Box](./images/gcs_cloud_create_cred.png)
       </Frame>
    3. Select "Web Application" as the application type:
       <Frame>
         ![Create OAuth Client](./images/create_oauth_client.png)
       </Frame>

    ### Redirect URI Configuration
    Add the following redirect URI to your OAuth client configuration:
    ```text
    https://{your-glean-domain-name}-be.glean.com/tools/oauth/verify_code/{your-action-unique-identifier-name}
    ```

    <Warning>
    The unique identifier in the redirect URI must match exactly with the identifier you set when creating the action, including case sensitivity.
    </Warning>

    ### OAuth Settings in Glean
    Configure these OAuth settings in the Authentication section:
    ```text
    Client URL: https://accounts.google.com/o/oauth2/auth?prompt=consent&access_type=offline
    Authorization URL: https://accounts.google.com/o/oauth2/token
    Scopes: https://www.googleapis.com/auth/documents
    ```

    ### Enable Google Docs API
    1. Navigate to the Google Cloud Console
    2. Enable the Google Docs API for your project:
       <Frame>
         ![GCP Google Docs API Settings](./images/google_docs_api.png)
       </Frame>
  </Step>

  <Step title="Testing and Deployment">
    After configuration, thoroughly test the action before deployment.

    ### Testing Process
    1. Click the testing URL provided after saving the action
    2. Issue test queries to verify proper triggering
    3. Use the "Review and confirm" interface:
       <Frame>
         ![Chat Execution Modal Form](./images/fe_modal_form.png)
       </Frame>
    4. Verify document changes:
       <Frame>
         Before changes:
         ![State of Doc before Action Execution](./images/before_doc.png)
       </Frame>
       <Frame>
         After changes:
         ![State of Doc after Action Execution](./images/after_doc.png)
       </Frame>

    ### Deployment Configuration
    Deploy the action through the deploy tab:
    <Frame>
      ![Deploy Action View](./images/deploy_window.png)
    </Frame>

    You can:
    - Enable the action for all teammates
    - Restrict access to specific teammates
    - Configure deployment settings for Chat or AI Apps integration
  </Step>
</Steps>

---

## Implementation Guidelines

### OpenAPI Specification Best Practices

When preparing your OpenAPI specification for Google Docs integration:

<Card title="Field Descriptions" icon="book">
  The quality of field descriptions significantly impacts Glean Assistant's ability to populate them correctly. Consider these guidelines:

  - Make descriptions actionable and specific
  - Include examples of valid values
  - Explain the business context of each field
  - Clarify relationships between fields
</Card>

<Card title="Schema Structure" icon="sitemap">
  Your schema structure affects how Glean Assistant interprets the API:

  - Keep the schema as flat as possible
  - Use meaningful field names that reflect their purpose
  - Leverage built-in formats (like `date-time`) where applicable
  - Include proper type constraints and validations
</Card>

### Google Docs API Considerations

When working with the Google Docs API:

<Card title="Document Operations" icon="file-pen">
  Choose the right operation type for your use case:

  - Use `insertText` for adding new content without affecting existing text
  - Use `replaceAllText` when you need to modify existing content
  - Consider using `index: 1` for insertions to maintain consistent behavior
  - Handle formatting through plain text markers (like asterisks for bullets)
</Card>

<Card title="Error Handling" icon="bug">
  Common issues to watch for:

  - Document permissions mismatches
  - Rate limiting constraints
  - Invalid document IDs
  - Concurrent modification conflicts
</Card>

### Authentication Setup Tips

<Card title="OAuth Configuration" icon="key">
  Important considerations for OAuth setup:

  - Always use `access_type=offline` to enable refresh tokens
  - Include appropriate error handling for token expiration
  - Consider implementing token rotation for security
  - Monitor token usage and implement proper logging
</Card>

### Integration Best Practices

<Card title="User Experience" icon="user">
  Optimize the action for user interaction:

  - Provide clear feedback when the action is processing
  - Include meaningful error messages
  - Allow users to preview changes before applying them
  - Maintain consistent behavior across different document types
</Card>

<Card title="Performance Optimization" icon="gauge">
  Ensure efficient operation:

  - Batch related operations when possible
  - Implement appropriate timeouts
  - Cache frequently used document metadata
  - Monitor action execution times
</Card>

### Common Pitfalls to Avoid

<Warning>
  Watch out for these common implementation mistakes:

  1. **Document ID Handling**
     - Not properly extracting IDs from URLs
     - Failing to validate ID format
     - Not handling shared drive documents correctly

  2. **Permission Issues**
     - Insufficient OAuth scopes
     - Missing document-level permissions
     - Incorrect service account configuration

  3. **Content Formatting**
     - Ignoring existing document structure
     - Not handling special characters properly
     - Incorrect handling of line breaks and paragraphs
</Warning>

### Testing Recommendations

<Card title="Comprehensive Testing" icon="vial">
  Implement thorough testing across these scenarios:

  - Different document types and sizes
  - Various content modification patterns
  - Edge cases in text replacement
  - Multiple user permission levels
  - Concurrent access situations
</Card>

### Maintenance and Monitoring

<Card title="Ongoing Operations" icon="chart-line">
  Establish these operational practices:

  - Regular OAuth credential rotation
  - Usage pattern monitoring
  - Error rate tracking
  - User feedback collection
  - Performance metric monitoring
</Card>

## Troubleshooting

If you encounter issues during setup or execution:

1. Verify OAuth credentials are correctly configured
2. Ensure the Google Docs API is enabled
3. Check that the redirect URI exactly matches your action's configuration
4. Verify the user has appropriate permissions in both Glean and Google Docs

## Next Steps

After successful implementation, consider:
- Creating documentation for end users
- Setting up monitoring for action usage
- Establishing a process for maintaining OAuth credentials
- Planning for periodic reviews of API specifications as the Google Docs API evolves